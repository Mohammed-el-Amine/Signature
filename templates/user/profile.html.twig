{% extends 'base.html.twig' %}

{% block title %}Profil{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
.custom-select {
    position: relative;
    display: inline-block;
}

.dropdown-list {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background-color: #ffffff;
    border: 1px solid #ccc;
    border-top: none;
    z-index: 100;
    display: none;
}

.dropdown-list .dropdown-item {
    padding: 5px;
    cursor: pointer;
}

.dropdown-list .dropdown-item:hover {
    background-color: #f0f0f0;
}

    </style>
{% endblock %}

{% block body %}
<button type="button" class="btn btn-logout" onclick="logout()">Déconnexion</button>
<h1>Profil</h1>

{{ form_start(form) }}
<div class="form-group">
    {{ form_label(form.email, 'Email') }}
    {{ form_widget(form.email, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(form.password, 'Mot de passe') }}
    <div class="input-group">
        {{ form_widget(form.password, {'attr': {'class': 'form-control', 'type': 'password'}}) }}
        <div class="input-group-append">
            <button type="button" class="btn btn-outline-secondary" onclick="togglePasswordVisibility()">Afficher</button>
        </div>
    </div>
</div>
<button type="submit" class="btn btn-primary">Enregistrer</button>
{{ form_end(form) }}

<h1>Liste des signatures</h1>

<ol>
    {% for signature in signatures %}
        <p>signature n°{{signature.id}}</p>
        <p>{{ signature.htmlCode|raw }}</p>
    {% endfor %}
</ol>

<h2>Formulaire de signature :</h2>

{{ form_start(signatureForm) }}
<div class="form-group">
    {{ form_label(signatureForm.name, 'Nom') }}
    {{ form_widget(signatureForm.name, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.job_title, 'Titre du poste') }}
    {{ form_widget(signatureForm.job_title, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.organization, 'Organisation') }}
    {{ form_widget(signatureForm.organization, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.logo_id, 'Logo') }}
    <div class="custom-select">
        <div class="select-trigger" onclick="toggleDropdown()">
            <span>Sélectionner un logo</span>
            <i class="fas fa-chevron-down"></i>
        </div>
        <div class="dropdown-list" id="dropdownList">
            {% for key, choice in signatureForm.logo_id.vars.choices %}
                <div class="dropdown-item" onclick="selectLogoOption('{{ key }}')">
                    <img src="{{ choice.label }}" alt="Logo">
                </div>
            {% endfor %}
        </div>
    </div>
    {{ form_widget(signatureForm.logo_id, {'attr': {'style': 'display: none'}}) }}
</div>



<div class="form-group">
    {{ form_label(signatureForm.adress, 'Adresse') }}
    {{ form_widget(signatureForm.adress, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.postal_code, 'Code postal') }}
    {{ form_widget(signatureForm.postal_code, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.city, 'Ville') }}
    {{ form_widget(signatureForm.city, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.email, 'Email') }}
    {{ form_widget(signatureForm.email, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.phone, 'Téléphone') }}
    {{ form_widget(signatureForm.phone, {'attr': {'class': 'form-control'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.html_code|raw, 'Code HTML') }}
    {{ form_widget(signatureForm.html_code|raw, {'attr': {'class': 'form-control', 'id': 'html-code'}}) }}
</div>
<div class="form-group">
    {{ form_label(signatureForm.baniere, 'Bannière') }}
    {{ form_widget(signatureForm.baniere, {'attr': {'class': 'form-control'}}) }}
</div>

<button type="submit" class="btn btn-primary">Enregistrer</button>
{{ form_end(signatureForm) }}
<img src="img/oeil_fermer.png"/>


<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>

    function togglePasswordVisibility() {
        const passwordInput = document.getElementById("{{ form.password.vars.id }}");
        const passwordButtonType = passwordInput.getAttribute("type");

        if (passwordButtonType === "password") {
            passwordInput.setAttribute("type", "text");
        } else {
            passwordInput.setAttribute("type", "password");
        }
    }

    function logout() {
        window.location.href = "{{ path('logout') }}";
}

        function selectLogoOption(option) {
    var value = option.getAttribute('data-value');
    var select = document.getElementById('{{ signatureForm.logo_id.vars.id }}');
    select.value = value;

    }

    function toggleDropdown() {
    var dropdownList = document.getElementById("dropdownList");
    dropdownList.style.display = dropdownList.style.display === "none" ? "block" : "none";
}

</script>
{% endblock %}
